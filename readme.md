# Dataset Exploration

The project wants to analyze a dataset containing a list of vulnerabilities affecting IT tools
All IT bugs are saved in a list mainteined by Mitre, a cybersecurity organization, called CVE

The main goal of the project is to classify a list of servers using CVE database and other parameters
The classification result can be very useful for IT managers in order to plan the remediation

The project contains the following files:
- ```cve_exploration.py```: python code to reach the main goal
- ```tasks.md```: file to track project activities
- ```data``` folder: containing dataset CSV files
- ```test``` folder: python code to test project features
    - ```python_raw.py```: file to test python commands
- ```utils``` folder: external python code
    - ```server_generator.py```: file to generate a new list of servers
    - ```column_descriptor.py```: file to export columns help for each datasets
- ```requirements.txt```: required python libraries

To launch the project you need to satisfy the requirements present in ```requirements.txt``` file and run the following command: ```streamlit run .\cve_exploration.py```

## Source files
All source files are stored in ```data``` folder and they are CSV files

### CVE dataset
Dataset cointaining all CVEs

Columns:
- ```cve_id```: CVE ID
- ```mod_date```: last modified date
- ```pub_date```: publication date
- ```cvss```: Common Vulnerability Scoring System (CVSS) score, a measure of the severity of a vulnerability
- ```cwe_code```: Common Weakness Enumeration (CWE) code, identifying the type of weakness
- ```cwe_name```: The name associated with the CWE code
- ```summary```: A text summary of the vulnerability
- ```access_authentication```: users' authentication necessary to exploit the vulnerability (SINGLE referers to 1 users)
- ```access_complexity```: complexity for logging into systems to exploit the vulnerability
- ```access_vector```: where do logins come from
- ```impact_availability```: the exploit of the vulnerability can affect the availability of the system
- ```impact_confidentiality```: the exploit of the vulnerability can affect the confidentiality of the system
- ```impact_integrity```: the exploit of the vulnerability can affect the integrity of the system

> From https://nvd.nist.gov/vuln-metrics/cvss, CVSS score ratings
CVSS v2.0 Ratings: Low 0.0-3.9, Medium 4.0-6.9, High 7.0-10.0
CVSS v3.0 Ratings: None 0.0, Low 0.1-3.9, Medium 4.0-6.9, High 7.0-8.9, Critical  9.0-10.0

> https://cwe.mitre.org/about/index.html

> https://medium.com/@tosukriti5/cwe-vs-cve-1f0cb1cfcd19

### Products dataset
Dataset cointaining all CVEs associated to a product

Columns:
- ```cve_id```: CVE ID
- ```vulnerable_product```: identifier of the vulnerable product

### Vendors dataset
Dataset cointaining all CVEs associated to a vendor

Columns:
- ```cve_id```: CVE ID
- ```vendor```: identifier of the vendor which is the developer of the product affected by the cve specified

### Vendor_product dataset
Dataset cointaining the combination between vendors and products

Columns:
- ```id```: progessive identifier
- ```vendor```: identifier of the vendor 
- ```product```: identifier of the product 

### Servers dataset
Dataset containing servers to classify

Columns:
- ```server_name```: Name of the server
- ```product```: Product installed
- ```is_dmz```: If the server is in a DMZ LAN (0 = False)
- ```days_since_patching```: Difference in days since last patching
- ```is_eol```: If the server is in EOL (End Of Life) (0 = False)
- ```vulnerability_count```: Number of vulnerabilities which affects the server

### Useful information
- CVE and Vendor datasets can be combined using cve_id columns
- CVE and Products datasets can be combined using cve_id columns
- A new list of server can be generated with the following script: ```server_generation.py```. To execute the script, run the following command: ```python .\server_generation.py```

## Machine Learning

The main goal is to classify a set of servers by some parameters
The parameters used to classify are: ```[is_dmz,days_since_patching, vulnerability_count, is_eol]```
The algorithm used to classify the data is ```KMeans```
According to the elbow method, the minimun number of clusters to use is ```4```

### Classes label
Label given to each class

- ```low vulnerable```: servers which respect the following conditions:
    - Most of the servers are not in EOL period
    - Most of the servers are not in a DMZ network
    - Servers are affected by at most 500 vulnerabilities
- ```medium vulnerable```: servers which respect the following conditions:
    - half of the servers are not in EOL period
    - half of the servers can be in a DMZ network
    - Servers are affected by at most 1000 vulnerabilities
- ```high vulnerable```: servers which respect the following conditions:
    - half of the servers are not in EOL period
    - half of the servers can be in a DMZ network
    - Servers are affected by at most 2000 vulnerabilities
- ```critical vulnerable```: servers which respect the following conditions:
    - Most of the servers are in EOL period
    - Most of the servers are in a DMZ network
    - Servers are affected by at least 2000 vulnerabilities