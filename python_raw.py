import numpy as np
import os
import pandas as pd
import matplotlib.pyplot as plt

project_folder = os.getcwd()

## Reading datasets
cve_df = pd.read_csv(f'{project_folder}\\data\\cve.csv')
products_df = pd.read_csv(f'{project_folder}\\data\\products.csv')
vendors_df = pd.read_csv(f'{project_folder}\\data\\vendors.csv')
vendors_products_df = pd.read_csv(f'{project_folder}\\data\\vendor_product.csv')


# data cleaning

# CVE dataset
# print(cve_df.info())

for col in ['access_authentication', 'access_complexity', 'access_vector', 'impact_availability', 'impact_confidentiality', 'impact_integrity']:
    cve_df[col].fillna('NONE', inplace=True)

# print(cve_df.info())

cve_df.rename(columns={'Unnamed: 0': 'cve_id'}, inplace=True)

print(cve_df.info())

# Product dataset
# print(products_df.info())

# print(sum(products_df['vulnerable_product'].isnull()))

products_df.dropna(inplace=True)

print(products_df.info())

# Vendor dataset
# print(vendors_df.info())
vendors_df.rename(columns={'Unnamed: 0': 'cve_id'}, inplace=True)
# print(vendors_df.info())

# print(sum(vendors_df['vendor'].isnull()))

vendors_df.dropna(inplace=True)

print(vendors_df.info())

# Vendor products
# print(vendors_products_df.info())
vendors_products_df.rename(columns={'Unnamed: 0': 'id'}, inplace=True)
print(vendors_products_df.info())